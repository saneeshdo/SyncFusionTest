using Microsoft.AspNetCore.Mvc;
using Syncfusion.EJ2.DocumentEditor;
using System.IO;
using System.Text;
using System.Text.Json;
using System.Text.Json.Serialization;

namespace SyncFusionTest.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class SyncfusionController : ControllerBase
    {

        private readonly ILogger<SyncfusionController> _logger;

        public SyncfusionController(ILogger<SyncfusionController> logger)
        {
            _logger = logger;
        }

        [HttpPost]
        public void ExportSFDT()
        {
            var sfdtText = "{\"optimizeSfdt\":true,\"sec\":[{\"secpr\":{\"pw\":612,\"ph\":792,\"lm\":72,\"rm\":72,\"tm\":72,\"bm\":72,\"hd\":36,\"fd\":36,\"dfp\":0,\"doep\":0,\"bi\":0,\"bc\":\"NewPage\",\"enf\":2,\"fnf\":0,\"rif\":0,\"rie\":0,\"ifn\":1,\"ien\":1,\"pgns\":\"Arabic\",\"ncols\":1,\"eqw\":1,\"lbtc\":0,\"cols\":[]},\"b\":[{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":true,\"fsz\":\"12\",\"bi\":false},\"i\":[{\"cf\":{\"b\":true,\"fsz\":\"12\",\"bi\":false},\"tlp\":\"Testing Sfdt Conversion\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":true},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"bi\":false,\"ac\":true},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 1sahlgduysagdihsaljvyfytfdyusagduysaiuabcxhgfytfugyghsa\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 2\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"i\":true,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"i\":true,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 3\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 4\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"u\":1,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"u\":1,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 5\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 6\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":true,\"bi\":false},\"i\":[{\"cf\":{\"b\":true,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 7\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 8\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"hc\":1,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"hc\":1,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 9\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[{\"cf\":{\"b\":false,\"bi\":false},\"tlp\":\"TESTING LINE NOhsgkgsudifhbashgcjtfausygdascusagdyusa 10\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false,\"bi\":false},\"i\":[]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"b\":false},\"i\":[]}],\"hf\":{}}],\"cf\":{\"b\":false,\"i\":false,\"fsz\":11,\"ff\":\"Calibri\",\"u\":0,\"st\":0,\"ba\":0,\"hc\":0,\"fszbi\":11,\"ffbi\":\"Calibri\",\"ac\":false,\"ffa\":\"Calibri\",\"ffnfe\":\"Calibri\",\"fffe\":\"Calibri\"},\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":0,\"as\":0,\"ls\":1,\"lst\":0,\"ol\":0,\"bi\":false,\"klt\":false,\"kwn\":false,\"wc\":true,\"lif\":{}},\"fst\":{},\"tfl\":{},\"dtw\":36,\"tc\":0,\"enf\":0,\"hv\":\"\",\"sv\":\"\",\"fmt\":0,\"pt\":0,\"dhtml\":0,\"ffs\":1,\"comp\":0,\"stytbl\":0,\"bg\":{\"c\":\"#FFFFFF\"},\"sty\":[{\"n\":\"Normal\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lif\":{}},\"cf\":{},\"nx\":\"Normal\"},{\"n\":\"Heading 1\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":12,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":1,\"lif\":{}},\"cf\":{\"fsz\":16,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 1 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 1 Char\",\"t\":1,\"cf\":{\"fsz\":16,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Default Paragraph Font\",\"t\":1,\"cf\":{}},{\"n\":\"Heading 2\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":2,\"lif\":{}},\"cf\":{\"fsz\":13,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 2 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 2 Char\",\"t\":1,\"cf\":{\"fsz\":13,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 3\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":3,\"lif\":{}},\"cf\":{\"fsz\":12,\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 3 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 3 Char\",\"t\":1,\"cf\":{\"fsz\":12,\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 4\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":4,\"lif\":{}},\"cf\":{\"i\":true,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 4 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 4 Char\",\"t\":1,\"cf\":{\"i\":true,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 5\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":5,\"lif\":{}},\"cf\":{\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 5 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 5 Char\",\"t\":1,\"cf\":{\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 6\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":6,\"lif\":{}},\"cf\":{\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 6 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 6 Char\",\"t\":1,\"cf\":{\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 7\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":7,\"lif\":{}},\"cf\":{\"i\":true,\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 7 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 7 Char\",\"t\":1,\"cf\":{\"i\":true,\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 8\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":8,\"lif\":{}},\"cf\":{\"fsz\":10.5,\"ff\":\"Calibri Light\",\"fc\":\"#333333\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 8 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 8 Char\",\"t\":1,\"cf\":{\"fsz\":10.5,\"ff\":\"Calibri Light\",\"fc\":\"#333333\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 9\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":9,\"lif\":{}},\"cf\":{\"i\":true,\"fsz\":10.5,\"ff\":\"Calibri Light\",\"fc\":\"#333333\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"l\":\"Heading 9 Char\",\"nx\":\"Normal\"},{\"n\":\"Heading 9 Char\",\"t\":1,\"cf\":{\"i\":true,\"fsz\":10.5,\"ff\":\"Calibri Light\",\"fc\":\"#333333\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Header\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"as\":0,\"ls\":1,\"lst\":0,\"lif\":{}},\"cf\":{},\"b\":\"Normal\",\"nx\":\"Header\"},{\"n\":\"Footer\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"as\":0,\"ls\":1,\"lst\":0,\"lif\":{}},\"cf\":{},\"b\":\"Normal\",\"nx\":\"Footer\"}],\"li\":[],\"al\":[],\"cm\":[],\"r\":[],\"cx\":[],\"imgs\":{}}";

            var document = WordDocument.Save(sfdtText);
            FileStream file = new FileStream("sample.docx", FileMode.OpenOrCreate, FileAccess.ReadWrite);
            document.Save(file, Syncfusion.DocIO.FormatType.Docx);
            file.Close();
            document.Close();
        }

        [HttpGet]
        public string LoadSFDT()
        {
            string filePath = "sample.docx";

            var options = new JsonSerializerOptions
            {
                // Use ReferenceHandler to handle object cycles
                ReferenceHandler = ReferenceHandler.Preserve,
                WriteIndented = true // For pretty printing JSON
            };

            using FileStream fileStream = new FileStream(filePath, FileMode.Open, FileAccess.Read);
            // Load the .docx file into the WordDocument
            
            using Syncfusion.DocIO.DLS.WordDocument docIODocument = new(fileStream, Syncfusion.DocIO.FormatType.Docx);

            // Convert the WordDocument to an SFDT JSON string using serialization
            string sfdtContent = JsonSerializer.Serialize(docIODocument, options);

            var document = WordDocument.Save(sfdtContent);
            using FileStream file = new FileStream("sample1.docx", FileMode.OpenOrCreate, FileAccess.ReadWrite);
            document.Save(file, Syncfusion.DocIO.FormatType.Docx);
            file.Close();
            document.Close();
            // Close the document to release resources
            //docIODocument.Dispose();

            // Return the SFDT content
            return sfdtContent;
        }
    }
}
